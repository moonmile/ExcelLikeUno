# 設計方針

UNO API の複雑さを隠し、「Python の 1 クラス = Calc の 1 つの概念」として扱えるようにする。

- UNO オブジェクトを保持するラッパーの基底クラスを作る
- Calc 用のラッパーは、この基底クラスを継承する
- Spreadsheet, Range, Sheet なども同じパターンで統一
- インターフェース名を定数化して IDE 補完を効かせる
- 型ヒントを Protocol で定義して IDE 補完を強化

## 開発コード例

以下は、開発コード例です。

### UnoObject

```python
class UnoObject:
    def __init__(self, obj):
        self._obj = obj
        self._cache = {}

    def iface(self, name):
        if name not in self._cache:
            self._cache[name] = self._obj.queryInterface(name)
        return self._cache[name]
```

## Cell

```python
class Cell(UnoObject):
    @property
    def value(self):
        return self.iface("com.sun.star.table.XCell").getValue()

    @value.setter
    def value(self, v):
        self.iface("com.sun.star.table.XCell").setValue(v)

    @property
    def formula(self):
        return self.iface("com.sun.star.table.XCell").getFormula()

    @formula.setter
    def formula(self, f):
        self.iface("com.sun.star.table.XCell").setFormula(f)

    @property
    def props(self):
        return self.iface("com.sun.star.beans.XPropertySet")
```

## 利用時の例

```python
import uno
import excellikeuno as elu

(desktop, document, sheet) = uno.connect_to_calc()
cell = sheet.getCellByPosition(0, 0)  # A1 セルを取得
cell.value = 100
cell.formula = "=A1+B1"

print(cell.props.getPropertyValue("CellBackColor"))  # props 経由で取得
print(cell.CellBackColor) # 直接取得も可能

sheet.cell(1, 0).value = 200  # B1 セルを取得して値を設定
sheet.cell(2, 0).formula = "=A1+B1"  # C1 セルに数式を設定

``` 

# 参照ドキュメント

Spreadsheet Service Reference : file:///C:/Program%20Files/LibreOffice/sdk/docs/idl/ref/a23852.html

